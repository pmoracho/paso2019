group_by(nombre_agrupacion) %>%
summarise(votos = sum(votos)) %>%
arrange(-votos)
View()
votos %>%
left_join(listas,, by = "id_lista") %>%
left_join(agrupaciones, by = "id_agrupacion") %>%
left_join(categorias, by = "id_categoria") %>%
filter(id_categoria == 137) %>%
group_by(nombre_agrupacion) %>%
summarise(votos = sum(votos)) %>%
arrange(-votos)
mesas_totales %>%
filter(CODIGO_MESA == "0206300917X")
library("paso2019")
library("tidyverse")
mesas_totales %>%
filter(CODIGO_MESA == "0206300917X")
mesas_totales_lista %>%
filter(CODIGO_MESA == "0206300917X")
mesas_totales_agrp_politica %>%
filter(CODIGO_MESA == "0206300917X")
mesas_totales %>%
filter(CODIGO_MESA == "0206300917X")
# Distritos
mesas_totales_lista %>%
distinct(CODIGO_DISTRITO) %>%
left_join(descripcion_regiones, by = c('CODIGO_DISTRITO' = "CODIGO_REGION")) %>%
mutate(id = row_number()) %>%
select(id_distrito = id,
codigo_distrito = CODIGO_DISTRITO,
nombre_distrito = NOMBRE_REGION) -> distritos
mesas_totales_lista %>%
distinct(CODIGO_SECCION) %>%
left_join(descripcion_regiones, by = c('CODIGO_SECCION' = "CODIGO_REGION")) %>%
mutate(id = row_number()) %>%
select(id_seccion = id,
codigo_seccion = CODIGO_SECCION ,
nombre_seccion = NOMBRE_REGION) -> secciones
mesas_totales_lista %>%
distinct(CODIGO_CIRCUITO) %>%
left_join(descripcion_regiones, by = c('CODIGO_CIRCUITO' = "CODIGO_REGION")) %>%
mutate(id = row_number()) %>%
select(id_circuito = id,
codigo_circuito = CODIGO_CIRCUITO,
nombre_circuito = NOMBRE_REGION) -> circuitos
mesas_totales_lista %>%
distinct(CODIGO_MESA, CODIGO_DISTRITO, CODIGO_SECCION, CODIGO_CIRCUITO) %>%
left_join(distritos, by = c('CODIGO_DISTRITO' = "codigo_distrito")) %>%
left_join(secciones, by = c('CODIGO_SECCION' = "codigo_seccion")) %>%
left_join(circuitos, by = c('CODIGO_CIRCUITO' = "codigo_circuito")) %>%
mutate(id = row_number(),
escrutada = NA) %>%
select(id_mesa = id,
id_distrito,
id_seccion,
id_circuito,
codigo_mesa = CODIGO_MESA,
escrutada)  -> mesa
mesas %>%
filter(codigo_mesa == "0206300917X")
mesa %>%  glimpse()
mesas_totales_lista %>%
distinct(CODIGO_MESA, CODIGO_DISTRITO, CODIGO_SECCION, CODIGO_CIRCUITO) %>%
left_join(distritos, by = c('CODIGO_DISTRITO' = "codigo_distrito")) %>%
left_join(secciones, by = c('CODIGO_SECCION' = "codigo_seccion")) %>%
left_join(circuitos, by = c('CODIGO_CIRCUITO' = "codigo_circuito")) %>%
mutate(id = row_number(),
escrutada = NA) %>%
select(id_mesa = id,
id_distrito,
id_seccion,
id_circuito,
codigo_mesa = CODIGO_MESA,
escrutada)  -> mesas
m1 %>%
anti_join(m2, by=c("CODIGO_MESA" = "codigo_mesa"))
mesas %>%
filter(codigo_mesa == "0206300917X")
mesas_totales_agrp_politica %>%
filter(CODIGO_AGRUPACION %in% c("135", "136") & CODIGO_CATEGORIA == "000100000000000") %>%
group_by(CODIGO_MESA) %>%
summarize(FT=sum(ifelse(CODIGO_AGRUPACION == 135, VOTOS_AGRUPACION,0)),
JxC=sum(ifelse(CODIGO_AGRUPACION == 136, VOTOS_AGRUPACION,0))) %>%
filter(FT == 0 | JxC ==0) %>%
ungroup() %>%
summarize(FT = sum(FT==0), JxC = sum(JxC==0))
votos %>%
left_join(categorias) %>%
filter(codigo_categoria == "000100000000000") %>%
left_join(listas) %>%
left_join(agrupaciones) %>%
filter(codigo_agrupacion %in% c("135", "136")) %>%
group_by(id_mesa) %>%
summarize(FT=sum(ifelse(codigo_agrupacion == 135, votos,0)),
JxC=sum(ifelse(codigo_agrupacion == 136, votos,0))) %>%
filter(FT == 0 | JxC ==0) %>%
ungroup() %>%
summarize(FT = sum(FT==0), JxC = sum(JxC==0))
# votos
mesas_totales_lista %>%
distinct(CODIGO_MESA, CODIGO_CATEGORIA, CODIGO_LISTA, VOTOS_LISTA) %>%
left_join(categorias, by=c("CODIGO_CATEGORIA" = "codigo_categoria")) %>%
left_join(listas, by=c("CODIGO_LISTA" = "codigo_lista")) %>%
left_join(mesas, by=c("CODIGO_MESA" = "codigo_mesa")) %>%
mutate(id = row_number()) %>%
select(id_voto = id,
id_mesa,
id_categoria,
id_lista,
votos = VOTOS_LISTA) -> votos
mesas_totales_lista %>%
distinct(CODIGO_MESA, CODIGO_CATEGORIA, CODIGO_LISTA, VOTOS_LISTA) %>%
left_join(categorias, by=c("CODIGO_CATEGORIA" = "codigo_categoria"))
# Categorias
descripcion_postulaciones %>%
distinct(CODIGO_CATEGORIA, NOMBRE_CATEGORIA) %>%
mutate(id = row_number()) %>%
select(id_categoria = id,
codigo_categoria = CODIGO_CATEGORIA,
nombre_categoria = NOMBRE_CATEGORIA) -> categorias
# Categorias
descripcion_postulaciones %>%
distinct(CODIGO_CATEGORIA, NOMBRE_CATEGORIA) %>%
mutate(id = row_number()) %>%
select(id_categoria = id,
codigo_categoria = CODIGO_CATEGORIA,
nombre_categoria = NOMBRE_CATEGORIA) -> categorias
# votos
mesas_totales_lista %>%
distinct(CODIGO_MESA, CODIGO_CATEGORIA, CODIGO_LISTA, VOTOS_LISTA) %>%
left_join(categorias, by=c("CODIGO_CATEGORIA" = "codigo_categoria")) %>%
left_join(listas, by=c("CODIGO_LISTA" = "codigo_lista")) %>%
left_join(mesas, by=c("CODIGO_MESA" = "codigo_mesa")) %>%
mutate(id = row_number()) %>%
select(id_voto = id,
id_mesa,
id_categoria,
id_lista,
votos = VOTOS_LISTA) -> votos
# Listas
descripcion_postulaciones %>%
distinct(CODIGO_LISTA, NOMBRE_LISTA, CODIGO_AGRUPACION) %>%
left_join(agrupaciones, by = c("CODIGO_AGRUPACION" = "codigo_agrupacion")) %>%
mutate(id = row_number()) %>%
select(id_lista = id,
id_agrupacion,
codigo_lista = CODIGO_LISTA,
nombre_lista = NOMBRE_LISTA) -> listas
# Listas
descripcion_postulaciones %>%
distinct(CODIGO_LISTA, NOMBRE_LISTA, CODIGO_AGRUPACION) %>%
left_join(agrupaciones, by = c("CODIGO_AGRUPACION" = "codigo_agrupacion")) %>%
mutate(id = row_number()) %>%
select(id_lista = id,
id_agrupacion,
codigo_lista = CODIGO_LISTA,
nombre_lista = NOMBRE_LISTA) -> listas
# Meta_Agrupaciones
descripcion_postulaciones %>%
distinct(NOMBRE_AGRUPACION) %>%
mutate(id = row_number()) %>%
select(id_meta_agrupacion = id,
nombre_meta_agrupacion = NOMBRE_AGRUPACION) -> meta_agrupaciones
# Listas
descripcion_postulaciones %>%
distinct(CODIGO_LISTA, NOMBRE_LISTA, CODIGO_AGRUPACION) %>%
left_join(agrupaciones, by = c("CODIGO_AGRUPACION" = "codigo_agrupacion")) %>%
mutate(id = row_number()) %>%
select(id_lista = id,
id_agrupacion,
codigo_lista = CODIGO_LISTA,
nombre_lista = NOMBRE_LISTA) -> listas
agrupaciones %>% glimpse()
# Agrupaciones
descripcion_postulaciones %>%
distinct(CODIGO_AGRUPACION, NOMBRE_AGRUPACION) %>%
left_join(meta_agrupaciones, by = c("NOMBRE_AGRUPACION" = "nombre_meta_agrupacion")) %>%
mutate(id = row_number()) %>%
select(id_agrupacion = id,
id_meta_agrupacion,
codigo_agrupacion = CODIGO_AGRUPACION) -> agrupaciones
agrupaciones %>% glimpse()
# Listas
descripcion_postulaciones %>%
distinct(CODIGO_LISTA, NOMBRE_LISTA, CODIGO_AGRUPACION) %>%
left_join(agrupaciones, by = c("CODIGO_AGRUPACION" = "codigo_agrupacion")) %>%
mutate(id = row_number()) %>%
select(id_lista = id,
id_agrupacion,
codigo_lista = CODIGO_LISTA,
nombre_lista = NOMBRE_LISTA) -> listas
# Meta_Agrupaciones
descripcion_postulaciones %>%
distinct(NOMBRE_AGRUPACION) %>%
mutate(id = row_number()) %>%
select(id_meta_agrupacion = id,
nombre_meta_agrupacion = NOMBRE_AGRUPACION) -> meta_agrupaciones
# Agrupaciones
descripcion_postulaciones %>%
distinct(CODIGO_AGRUPACION, NOMBRE_AGRUPACION) %>%
left_join(meta_agrupaciones, by = c("NOMBRE_AGRUPACION" = "nombre_meta_agrupacion")) %>%
mutate(id = row_number()) %>%
select(id_agrupacion = id,
id_meta_agrupacion,
codigo_agrupacion = CODIGO_AGRUPACION) -> agrupaciones
# Categorias
descripcion_postulaciones %>%
distinct(CODIGO_CATEGORIA, NOMBRE_CATEGORIA) %>%
mutate(id = row_number()) %>%
select(id_categoria = id,
codigo_categoria = CODIGO_CATEGORIA,
nombre_categoria = NOMBRE_CATEGORIA) -> categorias
# Listas
descripcion_postulaciones %>%
distinct(CODIGO_LISTA, NOMBRE_LISTA, CODIGO_AGRUPACION) %>%
left_join(agrupaciones, by = c("CODIGO_AGRUPACION" = "codigo_agrupacion")) %>%
mutate(id = row_number()) %>%
select(id_lista = id,
id_agrupacion,
codigo_lista = CODIGO_LISTA,
nombre_lista = NOMBRE_LISTA) -> listas
# Distritos
mesas_totales_lista %>%
distinct(CODIGO_DISTRITO) %>%
left_join(descripcion_regiones, by = c('CODIGO_DISTRITO' = "CODIGO_REGION")) %>%
mutate(id = row_number()) %>%
select(id_distrito = id,
codigo_distrito = CODIGO_DISTRITO,
nombre_distrito = NOMBRE_REGION) -> distritos
# Secciones
mesas_totales_lista %>%
distinct(CODIGO_SECCION) %>%
left_join(descripcion_regiones, by = c('CODIGO_SECCION' = "CODIGO_REGION")) %>%
mutate(id = row_number()) %>%
select(id_seccion = id,
codigo_seccion = CODIGO_SECCION ,
nombre_seccion = NOMBRE_REGION) -> secciones
# Circuitos
mesas_totales_lista %>%
distinct(CODIGO_CIRCUITO) %>%
left_join(descripcion_regiones, by = c('CODIGO_CIRCUITO' = "CODIGO_REGION")) %>%
mutate(id = row_number()) %>%
select(id_circuito = id,
codigo_circuito = CODIGO_CIRCUITO,
nombre_circuito = NOMBRE_REGION) -> circuitos
# Mesas
mesas_totales_lista %>%
distinct(CODIGO_MESA, CODIGO_DISTRITO, CODIGO_SECCION, CODIGO_CIRCUITO) %>%
left_join(distritos, by = c('CODIGO_DISTRITO' = "codigo_distrito")) %>%
left_join(secciones, by = c('CODIGO_SECCION' = "codigo_seccion")) %>%
left_join(circuitos, by = c('CODIGO_CIRCUITO' = "codigo_circuito")) %>%
mutate(id = row_number(),
escrutada = NA) %>%
select(id_mesa = id,
id_distrito,
id_seccion,
id_circuito,
codigo_mesa = CODIGO_MESA,
escrutada)  -> mesas
# votos
mesas_totales_lista %>%
distinct(CODIGO_MESA, CODIGO_CATEGORIA, CODIGO_LISTA, VOTOS_LISTA) %>%
left_join(categorias, by=c("CODIGO_CATEGORIA" = "codigo_categoria")) %>%
left_join(listas, by=c("CODIGO_LISTA" = "codigo_lista")) %>%
left_join(mesas, by=c("CODIGO_MESA" = "codigo_mesa")) %>%
mutate(id = row_number()) %>%
select(id_voto = id,
id_mesa,
id_categoria,
id_lista,
votos = VOTOS_LISTA) -> votos
# Totales de votos por categoria
votos %>%
group_by(id_categoria) %>%
summarise(votos = sum(votos)) %>%
left_join(categorias, by = "id_categoria") %>%
select(id_categoria,
codigo_categoria,
nombre_categoria,
votos_totales = votos)  %>%
as.data.frame() -> categorias
mesas_totales_agrp_politica %>%
filter(CODIGO_AGRUPACION %in% c("135", "136") & CODIGO_CATEGORIA == "000100000000000") %>%
group_by(CODIGO_MESA) %>%
summarize(FT=sum(ifelse(CODIGO_AGRUPACION == 135, VOTOS_AGRUPACION,0)),
JxC=sum(ifelse(CODIGO_AGRUPACION == 136, VOTOS_AGRUPACION,0))) %>%
filter(FT == 0 | JxC ==0) %>%
ungroup() %>%
summarize(FT = sum(FT==0), JxC = sum(JxC==0))
votos %>%
left_join(categorias) %>%
filter(codigo_categoria == "000100000000000") %>%
left_join(listas) %>%
left_join(agrupaciones) %>%
filter(codigo_agrupacion %in% c("135", "136")) %>%
group_by(id_mesa) %>%
summarize(FT=sum(ifelse(codigo_agrupacion == 135, votos,0)),
JxC=sum(ifelse(codigo_agrupacion == 136, votos,0))) %>%
filter(FT == 0 | JxC ==0) %>%
ungroup() %>%
summarize(FT = sum(FT==0), JxC = sum(JxC==0))
usethis::use_data(meta_agrupaciones, overwrite = TRUE)
usethis::use_data(agrupaciones, overwrite = TRUE)
usethis::use_data(categorias, overwrite = TRUE)
usethis::use_data(listas, overwrite = TRUE)
usethis::use_data(mesas, overwrite = TRUE)
usethis::use_data(votos, overwrite = TRUE)
usethis::use_data(distritos, overwrite = TRUE)
usethis::use_data(secciones, overwrite = TRUE)
usethis::use_data(circuitos, overwrite = TRUE)
glimpse(categorias)
library(paso2019)
devtools::document()
library("roxygen2", lib.loc="~/R/i686-pc-linux-gnu-library/3.4")
mesas %>%
group_by(escrutada) %>%
summarize(cantidad=n()) %>%
mutate(escrutada = reorder(ifelse(escrutada, "Si", "No"), -cantidad),
prop = round(cantidad / nrow(mesas),2),
lab.ypos = cumsum(cantidad) - 0.5 * cantidad) %>%
ggplot(aes(x = "", y = cantidad, fill = escrutada)) +
geom_bar(width = 1, stat = "identity", color = "white") +
geom_text(aes(y = lab.ypos, label = paste(prop,"%")), color = "white") +
#coord_polar("y", start = 0) +
scale_fill_manual(values = c("#0073C2FF", "#868686FF")) +
theme_void()
library("tidyverse")
mesas %>%
group_by(escrutada) %>%
summarize(cantidad=n()) %>%
mutate(escrutada = reorder(ifelse(escrutada, "Si", "No"), -cantidad),
prop = round(cantidad / nrow(mesas),2),
lab.ypos = cumsum(cantidad) - 0.5 * cantidad) %>%
ggplot(aes(x = "", y = cantidad, fill = escrutada)) +
geom_bar(width = 1, stat = "identity", color = "white") +
geom_text(aes(y = lab.ypos, label = paste(prop,"%")), color = "white") +
coord_polar("y", start = 0) +
scale_fill_manual(values = c("#0073C2FF", "#868686FF")) +
theme_void()
mesas %>%
ggplot(aes(x=escrutada, y=cantidad, fill=escrutada)) +
geom_col() +
coord_polar()
mesas %>%
group_by(escrutada) %>%
summarize(cantidad=n()) %>%
mutate(escrutada = reorder(ifelse(escrutada, "Si", "No"), -cantidad),
prop = round(cantidad / nrow(mesas),2),
lab.ypos = cumsum(cantidad) - 0.5 * cantidad) %>%
ggplot(aes(x=escrutada, y=cantidad, fill=escrutada)) +
geom_col() +
coord_polar()
mesas %>%
group_by(escrutada) %>%
summarize(cantidad=n()) %>%
mutate(escrutada = reorder(ifelse(escrutada, "Si", "No"), -cantidad),
prop = round(cantidad / nrow(mesas),2),
lab.ypos = cumsum(cantidad) - 0.5 * cantidad) %>%
ggplot(aes(x=escrutada, y=cantidad, fill=escrutada)) +
geom_col()
mesas %>%
group_by(escrutada) %>%
summarize(cantidad=n()) %>%
mutate(escrutada = reorder(ifelse(escrutada, "Si", "No"), -cantidad),
prop = round(cantidad / nrow(mesas),2),
lab.ypos = cumsum(cantidad) - 0.5 * cantidad)
mesas %>%
group_by(escrutada) %>%
summarize(cantidad=n())
# Mesas
mesas_totales_lista %>%
distinct(CODIGO_MESA, CODIGO_DISTRITO, CODIGO_SECCION, CODIGO_CIRCUITO) %>%
left_join(distritos, by = c('CODIGO_DISTRITO' = "codigo_distrito")) %>%
left_join(secciones, by = c('CODIGO_SECCION' = "codigo_seccion")) %>%
left_join(circuitos, by = c('CODIGO_CIRCUITO' = "codigo_circuito")) %>%
mutate(id = row_number(),
escrutada = NA) %>%
select(id_mesa = id,
id_distrito,
id_seccion,
id_circuito,
codigo_mesa = CODIGO_MESA,
escrutada)  -> mesas
glimpse(meta_agrupaciones)
secciones
distrito
distritos
meta_agrupaciones
glimpse(meta_agrupaciones)
glimpse(agrupaciones)
glimpse(meta_agrupaciones)
glimpse(agrupaciones)
devtools::document()
library(paso2019)
glimpse(categorias)
head(categorias)
head(categorias$nombre_categoria)
glimpse(categorias)
glimpse(listas)
glimpse(mesas)
library("paso2019")
library("tidyverse")
secciones %>% head()
votos %>%
left_join(mesas) %>%
left_join(secciones) %>%
head()
votos %>%
left_join(mesas) %>%
left_join(secciones) %>%
group_by(nombre_seccion) %>%
summarize(JxC=sum(ifelse(codigo_agrupacion == 135, votos,0)),
FdT=sum(ifelse(codigo_agrupacion == 136, votos,0))) %>%
head()
votos %>%
left_join(mesas) %>%
left_join(secciones) %>%
left_join(listas) %>%
group_by(nombre_seccion) %>%
summarize(JxC=sum(ifelse(codigo_agrupacion == 135, votos,0)),
FdT=sum(ifelse(codigo_agrupacion == 136, votos,0))) %>%
head()
votos %>%
left_join(mesas) %>%
left_join(secciones) %>%
left_join(listas) %>%
left_join(agrupaciones) %>%
group_by(nombre_seccion) %>%
summarize(JxC=sum(ifelse(codigo_agrupacion == 135, votos,0)),
FdT=sum(ifelse(codigo_agrupacion == 136, votos,0))) %>%
head()
agrupaciones %>%
filter(codigo_agrupacion==136)
agrupaciones %>%
left_join(meta_agrupaciones) %>%
filter(codigo_agrupacion==136)
votos %>%
left_join(mesas) %>%
left_join(distritos) %>%
left_join(secciones) %>%
left_join(listas) %>%
left_join(agrupaciones) %>%
group_by(nombre_distrito, nombre_seccion) %>%
summarize(JxC=sum(ifelse(codigo_agrupacion == 135, votos,0)),
FdT=sum(ifelse(codigo_agrupacion == 136, votos,0))) %>%
ungroup() -> votos_x_distritos_secciones
View(votos_x_distritos_secciones)
categorias
votos %>%
left_join(mesas, by = "id_mesa") %>%
left_join(distritos, by = "id_distrito") %>%
left_join(secciones) %>%
left_join(listas) %>%
left_join(agrupaciones) %>%
filter(id_categoria == 137)
group_by(nombre_distrito, nombre_seccion) %>%
summarize(JxC=sum(ifelse(codigo_agrupacion == 135, votos,0)),
FdT=sum(ifelse(codigo_agrupacion == 136, votos,0))) %>%
ungroup() -> votos_x_distritos_secciones
votos %>%
left_join(mesas, by = "id_mesa") %>%
left_join(distritos, by = "id_distrito") %>%
left_join(secciones) %>%
left_join(listas) %>%
left_join(agrupaciones) %>%
filter(id_categoria == 137) %>%
group_by(nombre_distrito, nombre_seccion) %>%
summarize(JxC=sum(ifelse(codigo_agrupacion == 135, votos,0)),
FdT=sum(ifelse(codigo_agrupacion == 136, votos,0))) %>%
ungroup() -> votos_x_distritos_secciones
View(votos_x_distritos_secciones)
votos %>%
left_join(mesas, by = "id_mesa") %>%
left_join(distritos, by = "id_distrito") %>%
left_join(secciones, by = "id_seccion") %>%
left_join(listas, by = "id_lista") %>%
left_join(agrupaciones, by = "id_agrupacion") %>%
filter(id_categoria == 137) %>%
group_by(nombre_distrito, nombre_seccion) %>%
summarize(JxC=sum(ifelse(codigo_agrupacion == 135, votos,0)),
FdT=sum(ifelse(codigo_agrupacion == 136, votos,0))) %>%
mutate(diferencia = FdT - JxC) %>%
arrange(-Diferencia) %>%
ungroup() -> votos_x_distritos_secciones
votos %>%
left_join(mesas, by = "id_mesa") %>%
left_join(distritos, by = "id_distrito") %>%
left_join(secciones, by = "id_seccion") %>%
left_join(listas, by = "id_lista") %>%
left_join(agrupaciones, by = "id_agrupacion") %>%
filter(id_categoria == 137) %>%
group_by(nombre_distrito, nombre_seccion) %>%
summarize(JxC=sum(ifelse(codigo_agrupacion == 135, votos,0)),
FdT=sum(ifelse(codigo_agrupacion == 136, votos,0))) %>%
mutate(diferencia = FdT - JxC) %>%
arrange(-diferencia) %>%
ungroup() -> votos_x_distritos_secciones
View(votos_x_distritos_secciones)
library("paso2019")
library("tidyverse")
votos_x_distritos_secciones %>%
arrange(diferencia)
cant <- 10
numeros <- c()
cant <- 10
numeros <- c()
for (n in 1:cant) {
numeros <- c(numeros, 2^n)
}
numeros
2^rep(1:cant)
